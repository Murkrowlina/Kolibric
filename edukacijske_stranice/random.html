<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <input type="text" id="inp">
    <input type="submit" value="submit" onClick="Trazi()">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>

    <script>

    fetch('https://random-word-api.herokuapp.com/word')
        .then(response => response.json())
        .then(response => {
            prevedi(response);
            console.log(response[0]);
        })
        .catch(err => console.error(err));

        function prevedi(res){
            const encodedParams = new URLSearchParams();
            encodedParams.append("source_language", "en");
            encodedParams.append("target_language", "hr");
            encodedParams.append("text", res);

            const options = {
                method: 'POST',
                headers: {
                    'content-type': 'application/x-www-form-urlencoded',
                    'X-RapidAPI-Key': '5c034aba24msh260b25bd35fbbd7p1a75bejsn54b6d9190803',
                    'X-RapidAPI-Host': 'text-translator2.p.rapidapi.com'
                },
                body: encodedParams
            };

            fetch('https://text-translator2.p.rapidapi.com/translate', options)
            .then(response => response.json())
            .then(response => {
                console.log(response.data.translatedText)
            })
            .catch(err => console.error(err));
        }

        function Trazi(){
            var name = document.getElementById('inp').value;
            
            const encodedParams = new URLSearchParams();
            encodedParams.append("source_language", "hr");
            encodedParams.append("target_language", "en");
            encodedParams.append("text", name);

            const options = {
                method: 'POST',
                headers: {
                    'content-type': 'application/x-www-form-urlencoded',
                    'X-RapidAPI-Key': '5c034aba24msh260b25bd35fbbd7p1a75bejsn54b6d9190803',
                    'X-RapidAPI-Host': 'text-translator2.p.rapidapi.com'
                },
                body: encodedParams
            };

            fetch('https://text-translator2.p.rapidapi.com/translate', options)
            .then(response => response.json())
            .then(response => 
                $.ajax({
                    method: 'GET',
                    url: 'https://api.api-ninjas.com/v1/animals?name=' + response.data.translatedText,
                    headers: { 'X-Api-Key': '6pEhJP4JYyzY7QmxMdyx/g==gB6Zxmg3kutrZy5d'},
                    contentType: 'application/json',
                    success: function(result) {
                        console.log(result);
                        unsplashImage(result[0])
                    },
                    error: function ajaxError(jqXHR) {
                        console.error('Error: ', jqXHR.responseText);
                    }
                })
            )
            .catch(err => console.error(err));

        }
        
        function unsplashImage(query){
            console.log(query)
            let q = query.name.split(' ');
            console.log(q)
            console.log(`https://api.unsplash.com/search/photos?query=${q[0]}%20${q[1]}`)
            const accessKey = 'UKhct7FDyDd6ymCMHtSsv2OLw_3YdXVdR6R7_JqqD_w';
            fetch(`https://api.unsplash.com/search/photos?query=${q[0]}%20${q[1]}`, {
                headers: {
                    Authorization: `Client-ID ${accessKey}`
                }
            })
            .then(response => response.json())
            .then(data => {
                data.results.forEach(photo => {
                    const img = document.createElement('img');
                    img.src = photo.urls.regular;
                    document.body.appendChild(img);
                });
            })
            .catch(error => {
                console.log(error);
            });
        }
    </script>
</body>
</html>